<!DOCTYPE html>
<html lang="eng">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Apex Gym Blog Management" />
    <meta name="keywords" content="Gym, Admin, Blog, Management" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Apex Gym - Blog Management</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&amp;display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Oswald:300,400,500,600,700&amp;display=swap"
      rel="stylesheet"
    />

    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />

    <style>
      /* Global black background */
      body {
        background-color: #000;
        color: #fff;
        min-height: 100vh;
      }

      .admin-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
      }

      .admin-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
        border-bottom: 1px solid #333;
        margin-bottom: 30px;
      }

      .admin-logo {
        display: flex;
        align-items: center;
      }

      .admin-logo img {
        max-width: 80px;
        margin-right: 15px;
      }

      .admin-title h1 {
        color: #e53637;
        margin: 0;
        font-size: 24px;
      }

      .admin-nav {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
      }

      .nav-btn {
        background: #1a1a1a;
        color: #b7b7b7;
        border: 1px solid #333;
        padding: 10px 20px;
        border-radius: 4px;
        text-decoration: none;
        transition: all 0.3s;
      }

      .nav-btn:hover,
      .nav-btn.active {
        background: #e53637;
        color: #fff;
        text-decoration: none;
      }

      .admin-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .search-box {
        display: flex;
        gap: 10px;
      }

      .search-input {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 4px;
        padding: 10px 15px;
        color: #fff;
        min-width: 300px;
      }

      .search-input:focus {
        outline: none;
        border-color: #e53637;
      }

      .btn-primary {
        background: #e53637;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .btn-primary:hover {
        background: #fff;
        color: #e53637;
      }

      .blog-posts {
        display: grid;
        gap: 20px;
      }

      .blog-post-card {
        background: #1a1a1a;
        border-radius: 8px;
        border: 1px solid #333;
        overflow: hidden;
        transition: all 0.3s;
      }

      .blog-post-card:hover {
        transform: translateY(-2px);
        border-color: #e53637;
      }

      .blog-post-header {
        padding: 20px;
        border-bottom: 1px solid #333;
      }

      .blog-post-title {
        color: #fff;
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 10px;
      }

      .blog-post-meta {
        display: flex;
        gap: 15px;
        color: #b7b7b7;
        font-size: 14px;
      }

      .blog-post-content {
        padding: 20px;
      }

      .blog-post-excerpt {
        color: #b7b7b7;
        line-height: 1.6;
        margin-bottom: 15px;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .blog-post-actions {
        display: flex;
        gap: 10px;
      }

      .btn-edit {
        background: #333;
        color: #fff;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .btn-edit:hover {
        background: #555;
      }

      .btn-delete {
        background: #e53637;
        color: #fff;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .btn-delete:hover {
        background: #c42b2c;
      }

      .btn-preview {
        background: #2a2a2a;
        color: #fff;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        transition: all 0.3s;
      }

      .btn-preview:hover {
        background: #3a3a3a;
        text-decoration: none;
        color: #fff;
      }

      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #b7b7b7;
      }

      .empty-state i {
        font-size: 48px;
        margin-bottom: 20px;
        color: #333;
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
      }

      .modal-content {
        background: #1a1a1a;
        margin: 2% auto;
        padding: 30px;
        border-radius: 10px;
        width: 90%;
        max-width: 900px;
        border: 2px solid #e53637;
        max-height: 96vh;
        overflow-y: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
      }

      .modal-title {
        color: #e53637;
        font-size: 24px;
        margin: 0;
      }

      .close-modal {
        background: none;
        border: none;
        color: #b7b7b7;
        font-size: 24px;
        cursor: pointer;
      }

      .close-modal:hover {
        color: #fff;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        color: #b7b7b7;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .form-control {
        width: 100%;
        padding: 12px 15px;
        background: #222;
        border: 1px solid #333;
        border-radius: 4px;
        color: #fff;
        font-size: 14px;
      }

      .form-control:focus {
        outline: none;
        border-color: #e53637;
      }

      textarea.form-control {
        min-height: 120px;
        resize: vertical;
      }

      #blogContent {
        min-height: 300px;
        font-family: monospace;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .modal-actions {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 25px;
      }

      .btn-cancel {
        background: #333;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
      }

      .btn-cancel:hover {
        background: #444;
      }

      .btn-save {
        background: #e53637;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
      }

      .btn-save:hover {
        background: #fff;
        color: #e53637;
      }

      .status-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
      }

      .status-published {
        background: rgba(46, 204, 113, 0.2);
        color: #2ecc71;
      }

      .status-draft {
        background: rgba(241, 196, 15, 0.2);
        color: #f1c40f;
      }

      @media (max-width: 768px) {
        .admin-header {
          flex-direction: column;
          text-align: center;
          gap: 15px;
        }

        .admin-actions {
          flex-direction: column;
          gap: 15px;
          align-items: stretch;
        }

        .search-box {
          width: 100%;
        }

        .search-input {
          min-width: auto;
          flex: 1;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .modal-content {
          margin: 5% auto;
          padding: 20px;
        }

        .blog-post-meta {
          flex-direction: column;
          gap: 5px;
        }
      }
    </style>
  </head>

  <body>
    <div class="admin-container">
      <!-- Admin Header -->
      <div class="admin-header">
        <div class="admin-logo">
          <img src="img/logo.png" alt="Apex Gym" />
          <div class="admin-title">
            <h1>Blog Management</h1>
          </div>
        </div>
        <div class="admin-user">
          <button
            class="btn-primary"
            onclick="location.href='admin-dashboard.html'"
          >
            Back to Dashboard
          </button>
        </div>
      </div>

      <!-- Navigation -->
      <div class="admin-nav">
        <a href="admin-dashboard.html" class="nav-btn">Dashboard</a>
        <a href="admin-shop.html" class="nav-btn">Shop</a>
        <a href="admin-blog.html" class="nav-btn active">Blog</a>
        <a href="admin-users.html" class="nav-btn">Users</a>
        <a href="admin-orders.html" class="nav-btn">Orders</a>
      </div>

      <!-- Actions -->
      <div class="admin-actions">
        <div class="search-box">
          <input
            type="text"
            class="search-input"
            placeholder="Search blog posts..."
            id="searchInput"
          />
          <button class="btn-primary" onclick="searchBlogPosts()">
            Search
          </button>
        </div>
        <button class="btn-primary" onclick="openAddBlogModal()">
          <i class="fa fa-plus"></i> New Blog Post
        </button>
      </div>

      <!-- Blog Posts -->
      <div class="blog-posts" id="blogPostsContainer">
        <!-- Blog posts will be loaded here dynamically -->
      </div>

      <!-- Empty State -->
      <div class="empty-state" id="emptyState" style="display: none">
        <i class="fa fa-file-text"></i>
        <h3>No Blog Posts</h3>
        <p>Get started by creating your first blog post.</p>
        <button
          class="btn-primary"
          onclick="openAddBlogModal()"
          style="margin-top: 15px"
        >
          Create First Post
        </button>
      </div>
    </div>

    <!-- Add/Edit Blog Modal -->
    <div id="blogModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title" id="modalTitle">New Blog Post</h2>
          <button class="close-modal" onclick="closeBlogModal()">
            &times;
          </button>
        </div>
        <form id="blogForm">
          <input type="hidden" id="blogId" />

          <div class="form-group">
            <label class="form-label" for="blogTitle">Title</label>
            <input type="text" class="form-control" id="blogTitle" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="blogExcerpt">Excerpt</label>
            <textarea class="form-control" id="blogExcerpt" required></textarea>
          </div>

          <div class="form-group">
            <label class="form-label" for="blogContent">Content</label>
            <textarea class="form-control" id="blogContent" required></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="blogCategory">Category</label>
              <select class="form-control" id="blogCategory" required>
                <option value="">Select Category</option>
                <option value="fitness">Fitness</option>
                <option value="nutrition">Nutrition</option>
                <option value="lifestyle">Lifestyle</option>
                <option value="training">Training</option>
                <option value="health">Health</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="blogStatus">Status</label>
              <select class="form-control" id="blogStatus" required>
                <option value="published">Published</option>
                <option value="draft">Draft</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="blogImage">Featured Image URL</label>
            <input
              type="url"
              class="form-control"
              id="blogImage"
              placeholder="https://example.com/image.jpg"
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="blogTags"
              >Tags (comma separated)</label
            >
            <input
              type="text"
              class="form-control"
              id="blogTags"
              placeholder="fitness, nutrition, workout"
            />
          </div>

          <div class="modal-actions">
            <button type="button" class="btn-cancel" onclick="closeBlogModal()">
              Cancel
            </button>
            <button type="submit" class="btn-save">Save Post</button>
          </div>
        </form>
      </div>
    </div>

    <script>
      // Mock data for demonstration
      let blogPosts = JSON.parse(localStorage.getItem("admin_blog_posts")) || [
        {
          id: 1,
          title: "10 Essential Exercises for Beginners",
          excerpt:
            "Starting your fitness journey? Here are the 10 most important exercises every beginner should master.",
          content:
            "Starting a fitness journey can be overwhelming... [full content]",
          category: "fitness",
          status: "published",
          image:
            "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=600",
          tags: ["fitness", "beginners", "exercises"],
          createdAt: new Date("2024-01-15").toISOString(),
          author: "Admin",
        },
        {
          id: 2,
          title: "Nutrition Tips for Muscle Growth",
          excerpt:
            "Learn how to optimize your diet for maximum muscle growth and recovery.",
          content:
            "Proper nutrition is crucial for muscle growth... [full content]",
          category: "nutrition",
          status: "draft",
          image:
            "https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=600",
          tags: ["nutrition", "muscle growth", "diet"],
          createdAt: new Date("2024-01-10").toISOString(),
          author: "Admin",
        },
      ];

      document.addEventListener("DOMContentLoaded", function () {
        // Check authentication
        if (localStorage.getItem("admin_authenticated") !== "true") {
          window.location.href = "admin-login.html";
          return;
        }

        loadBlogPosts();
        setupEventListeners();
      });

      function setupEventListeners() {
        document
          .getElementById("blogForm")
          .addEventListener("submit", saveBlogPost);
        document
          .getElementById("searchInput")
          .addEventListener("input", searchBlogPosts);
      }

      function loadBlogPosts() {
        const blogContainer = document.getElementById("blogPostsContainer");
        const emptyState = document.getElementById("emptyState");

        if (blogPosts.length === 0) {
          blogContainer.style.display = "none";
          emptyState.style.display = "block";
          return;
        }

        blogContainer.style.display = "block";
        emptyState.style.display = "none";

        // Sort by creation date (newest first)
        const sortedPosts = [...blogPosts].sort(
          (a, b) => new Date(b.createdAt) - new Date(a.createdAt)
        );

        blogContainer.innerHTML = sortedPosts
          .map(
            (post) => `
          <div class="blog-post-card">
            <div class="blog-post-header">
              <div class="blog-post-title">${post.title}</div>
              <div class="blog-post-meta">
                <span>Category: ${post.category}</span>
                <span>Created: ${new Date(
                  post.createdAt
                ).toLocaleDateString()}</span>
                <span>Status: <span class="status-badge status-${
                  post.status
                }">${post.status}</span></span>
                <span>Author: ${post.author}</span>
              </div>
            </div>
            <div class="blog-post-content">
              <div class="blog-post-excerpt">${post.excerpt}</div>
              <div class="blog-post-actions">
                <button class="btn-edit" onclick="editBlogPost(${post.id})">
                  <i class="fa fa-edit"></i> Edit
                </button>
                <button class="btn-delete" onclick="deleteBlogPost(${post.id})">
                  <i class="fa fa-trash"></i> Delete
                </button>
                <a href="#" class="btn-preview" onclick="previewBlogPost(${
                  post.id
                })">
                  <i class="fa fa-eye"></i> Preview
                </a>
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      function searchBlogPosts() {
        const searchTerm = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const filteredPosts = blogPosts.filter(
          (post) =>
            post.title.toLowerCase().includes(searchTerm) ||
            post.excerpt.toLowerCase().includes(searchTerm) ||
            post.category.toLowerCase().includes(searchTerm) ||
            post.tags.some((tag) => tag.toLowerCase().includes(searchTerm))
        );

        if (searchTerm === "") {
          loadBlogPosts();
        } else {
          renderFilteredPosts(filteredPosts);
        }
      }

      function renderFilteredPosts(filteredPosts) {
        const blogContainer = document.getElementById("blogPostsContainer");
        const emptyState = document.getElementById("emptyState");

        if (filteredPosts.length === 0) {
          blogContainer.style.display = "none";
          emptyState.style.display = "block";
          emptyState.innerHTML = `
            <i class="fa fa-search"></i>
            <h3>No Posts Found</h3>
            <p>No blog posts match your search criteria.</p>
          `;
          return;
        }

        blogContainer.style.display = "block";
        emptyState.style.display = "none";

        blogContainer.innerHTML = filteredPosts
          .map(
            (post) => `
          <div class="blog-post-card">
            <div class="blog-post-header">
              <div class="blog-post-title">${post.title}</div>
              <div class="blog-post-meta">
                <span>Category: ${post.category}</span>
                <span>Created: ${new Date(
                  post.createdAt
                ).toLocaleDateString()}</span>
                <span>Status: <span class="status-badge status-${
                  post.status
                }">${post.status}</span></span>
                <span>Author: ${post.author}</span>
              </div>
            </div>
            <div class="blog-post-content">
              <div class="blog-post-excerpt">${post.excerpt}</div>
              <div class="blog-post-actions">
                <button class="btn-edit" onclick="editBlogPost(${post.id})">
                  <i class="fa fa-edit"></i> Edit
                </button>
                <button class="btn-delete" onclick="deleteBlogPost(${post.id})">
                  <i class="fa fa-trash"></i> Delete
                </button>
                <a href="#" class="btn-preview" onclick="previewBlogPost(${
                  post.id
                })">
                  <i class="fa fa-eye"></i> Preview
                </a>
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      function openAddBlogModal() {
        document.getElementById("modalTitle").textContent = "New Blog Post";
        document.getElementById("blogForm").reset();
        document.getElementById("blogId").value = "";
        document.getElementById("blogModal").style.display = "block";
      }

      function closeBlogModal() {
        document.getElementById("blogModal").style.display = "none";
      }

      function editBlogPost(id) {
        const post = blogPosts.find((p) => p.id === id);
        if (!post) return;

        document.getElementById("modalTitle").textContent = "Edit Blog Post";
        document.getElementById("blogId").value = post.id;
        document.getElementById("blogTitle").value = post.title;
        document.getElementById("blogExcerpt").value = post.excerpt;
        document.getElementById("blogContent").value = post.content;
        document.getElementById("blogCategory").value = post.category;
        document.getElementById("blogStatus").value = post.status;
        document.getElementById("blogImage").value = post.image || "";
        document.getElementById("blogTags").value = post.tags
          ? post.tags.join(", ")
          : "";

        document.getElementById("blogModal").style.display = "block";
      }

      function saveBlogPost(e) {
        e.preventDefault();

        const blogId = document.getElementById("blogId").value;
        const blogData = {
          title: document.getElementById("blogTitle").value,
          excerpt: document.getElementById("blogExcerpt").value,
          content: document.getElementById("blogContent").value,
          category: document.getElementById("blogCategory").value,
          status: document.getElementById("blogStatus").value,
          image: document.getElementById("blogImage").value,
          tags: document
            .getElementById("blogTags")
            .value.split(",")
            .map((tag) => tag.trim())
            .filter((tag) => tag),
          author: "Admin",
          createdAt: blogId
            ? blogPosts.find((p) => p.id === parseInt(blogId)).createdAt
            : new Date().toISOString(),
        };

        if (blogId) {
          // Update existing post
          const index = blogPosts.findIndex((p) => p.id === parseInt(blogId));
          if (index !== -1) {
            blogPosts[index] = { ...blogPosts[index], ...blogData };
          }
        } else {
          // Add new post
          const newId =
            blogPosts.length > 0
              ? Math.max(...blogPosts.map((p) => p.id)) + 1
              : 1;
          blogPosts.push({ id: newId, ...blogData });
        }

        localStorage.setItem("admin_blog_posts", JSON.stringify(blogPosts));
        loadBlogPosts();
        closeBlogModal();

        // Show success message
        alert("Blog post saved successfully!");
      }

      function deleteBlogPost(id) {
        if (
          confirm(
            "Are you sure you want to delete this blog post? This action cannot be undone."
          )
        ) {
          blogPosts = blogPosts.filter((p) => p.id !== id);
          localStorage.setItem("admin_blog_posts", JSON.stringify(blogPosts));
          loadBlogPosts();
          alert("Blog post deleted successfully!");
        }
      }

      function previewBlogPost(id) {
        const post = blogPosts.find((p) => p.id === id);
        if (!post) return;

        // In a real application, this would open a preview window
        alert(
          `Preview for: "${post.title}"\n\nThis would open a preview window showing how the post looks to readers.`
        );
      }

      // Close modal when clicking outside
      window.onclick = function (event) {
        const modal = document.getElementById("blogModal");
        if (event.target === modal) {
          closeBlogModal();
        }
      };
    </script>
  </body>
</html>
