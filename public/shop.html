<!DOCTYPE html>
<html lang="eng">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Gym Template" />
    <meta name="keywords" content="Gym, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Ape-X Store</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&amp;display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Oswald:300,400,500,600,700&amp;display=swap"
      rel="stylesheet"
    />

    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="css/flaticon.css" type="text/css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="css/barfiller.css" type="text/css" />
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <style>
      /* Global black background */
      body {
        background-color: #000;
        color: #fff;
      }

      /* Override any existing white backgrounds */
      .shop-section,
      .breadcrumb-section,
      .header-section,
      .offcanvas-menu-wrapper,
      .gettouch-section,
      .footer-section {
        background-color: #000 !important;
      }

      .breadcrumb-section.set-bg {
        background-color: #111 !important;
      }

      /* Product styles */
      .product-item {
        background: #1a1a1a;
        border-radius: 5px;
        overflow: hidden;
        margin-bottom: 30px;
        transition: all 0.3s;
        border: 1px solid #333;
        height: 100%;
        display: flex;
        flex-direction: column;
      }
      .product-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(229, 54, 55, 0.2);
      }
      .product-img {
        position: relative;
        overflow: hidden;
        height: 250px;
        background-color: #222;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .product-img img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s;
      }
      .product-item:hover .product-img img {
        transform: scale(1.05);
      }
      .product-text {
        padding: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
      }
      .product-text h5 {
        color: #fff;
        font-weight: 600;
        margin-bottom: 10px;
        /* Limit product name to 2 lines */
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        min-height: 48px;
      }
      .product-text p {
        color: #e53637;
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 15px;
      }
      .product-text .primary-btn {
        display: inline-block;
        background: #e53637;
        color: #fff;
        padding: 10px 20px;
        border-radius: 4px;
        font-weight: 600;
        transition: all 0.3s;
        text-decoration: none;
        text-align: center;
        margin-top: auto;
      }
      .product-text .primary-btn:hover {
        background: #fff;
        color: #e53637;
        text-decoration: none;
      }
      .out-of-stock {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #e53637;
        color: #fff;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
      }
      .shop-sidebar {
        background: #1a1a1a;
        padding: 30px;
        border-radius: 5px;
        margin-bottom: 30px;
        border: 1px solid #333;
      }
      .shop-sidebar h4 {
        color: #fff;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #333;
      }
      .shop-sidebar ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .shop-sidebar ul li {
        margin-bottom: 10px;
      }
      .shop-sidebar ul li a {
        color: #b7b7b7;
        transition: all 0.3s;
        text-decoration: none;
      }
      .shop-sidebar ul li a:hover {
        color: #e53637;
        text-decoration: none;
      }
      .price-filter {
        margin-top: 20px;
      }
      .price-filter input {
        width: 100%;
        margin-bottom: 10px;
        background: #333;
        border: none;
        color: #fff;
        padding: 8px 15px;
        border-radius: 4px;
      }
      .price-filter button {
        width: 100%;
        background: #e53637;
        color: #fff;
        border: none;
        padding: 10px;
        border-radius: 4px;
        font-weight: 600;
        transition: all 0.3s;
      }
      .price-filter button:hover {
        background: #fff;
        color: #e53637;
      }
      .shop-pagination {
        text-align: center;
        margin-top: 30px;
      }
      .shop-pagination a {
        display: inline-block;
        width: 40px;
        height: 40px;
        line-height: 40px;
        text-align: center;
        background: #1a1a1a;
        color: #fff;
        margin: 0 5px;
        border-radius: 4px;
        transition: all 0.3s;
        text-decoration: none;
      }
      .shop-pagination a.active,
      .shop-pagination a:hover {
        background: #e53637;
        color: #fff;
        text-decoration: none;
      }
      .sorting-options {
        margin-bottom: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .sorting-options select {
        background: #1a1a1a;
        border: 1px solid #333;
        color: #fff;
        padding: 8px 15px;
        border-radius: 4px;
      }
      .view-options span {
        color: #fff;
        margin-right: 10px;
      }
      .view-options a {
        color: #b7b7b7;
        margin-right: 10px;
        transition: all 0.3s;
        text-decoration: none;
      }
      .view-options a.active,
      .view-options a:hover {
        color: #e53637;
        text-decoration: none;
      }

      /* Adjust header and footer for black background */
      .header-section {
        background-color: #000 !important;
        border-bottom: 1px solid #333;
      }

      .footer-section {
        background-color: #111 !important;
      }

      .gettouch-section {
        background-color: #111 !important;
        border-top: 1px solid #333;
        border-bottom: 1px solid #333;
      }

      /* Breadcrumb adjustments */
      .breadcrumb-text h2 {
        color: #fff;
      }

      .bt-option a {
        color: #e53637;
        text-decoration: none;
      }

      .bt-option span {
        color: #b7b7b7;
      }

      /* Cart and Profile Styles */
      .top-option {
        display: flex;
        align-items: center;
        justify-content: flex-end;
      }

      .cart-icon,
      .profile-icon {
        position: relative;
        margin-left: 20px;
        cursor: pointer;
      }

      .cart-icon i,
      .profile-icon i {
        font-size: 20px;
        color: #fff;
        transition: all 0.3s;
      }

      .cart-icon:hover i,
      .profile-icon:hover i {
        color: #e53637;
      }

      .cart-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background: #e53637;
        color: #fff;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      .profile-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 4px;
        padding: 10px 0;
        min-width: 150px;
        z-index: 1000;
        display: none;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .profile-dropdown a {
        display: block;
        padding: 8px 15px;
        color: #b7b7b7;
        text-decoration: none;
        transition: all 0.3s;
      }

      .profile-dropdown a:hover {
        background: #333;
        color: #e53637;
      }

      .profile-icon {
        position: relative;
      }

      .profile-icon:hover .profile-dropdown {
        display: block;
      }

      .cart-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 4px;
        padding: 15px;
        min-width: 280px;
        z-index: 1000;
        display: none;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .cart-icon {
        position: relative;
      }

      .cart-icon:hover .cart-dropdown {
        display: block;
      }

      .cart-items {
        max-height: 200px;
        overflow-y: auto;
      }

      .cart-item {
        display: flex;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #333;
      }

      .cart-item:last-child {
        border-bottom: none;
      }

      .cart-item img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        margin-right: 10px;
        border-radius: 4px;
      }

      .cart-item-details {
        flex-grow: 1;
      }

      .cart-item-name {
        color: #fff;
        font-size: 14px;
        margin-bottom: 5px;
      }

      .cart-item-price {
        color: #e53637;
        font-weight: bold;
        font-size: 14px;
      }

      .cart-total {
        display: flex;
        justify-content: space-between;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #333;
        font-weight: bold;
        color: #fff;
      }

      .cart-actions {
        margin-top: 15px;
        display: flex;
        gap: 10px;
      }

      .cart-actions a {
        flex: 1;
        text-align: center;
        padding: 8px 0;
        border-radius: 4px;
        font-size: 14px;
        text-decoration: none;
      }

      .view-cart {
        background: #333;
        color: #fff;
      }

      .checkout {
        background: #e53637;
        color: #fff;
      }

      .empty-cart {
        text-align: center;
        color: #b7b7b7;
        padding: 20px 0;
      }
    </style>
    <style>
      /* Updated Product Grid Styles for 4 per row with shorter cards */
      .shop-products-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 30px;
      }

      @media (max-width: 1200px) {
        .shop-products-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (max-width: 992px) {
        .shop-products-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 576px) {
        .shop-products-grid {
          grid-template-columns: 1fr;
        }
      }

      .product-item {
        background: #1a1a1a;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 0;
        transition: all 0.3s;
        border: 1px solid #333;
        height: 300px;
        display: flex;
        flex-direction: column;
      }

      .product-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 16px rgba(229, 54, 55, 0.2);
        border-color: #e53637;
      }

      .product-img {
        position: relative;
        overflow: hidden;
        height: 150px;
        background-color: #222;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .product-img img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s;
      }

      .product-item:hover .product-img img {
        transform: scale(1.05);
      }

      .product-text {
        padding: 15px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
      }

      .product-text h5 {
        color: #fff;
        font-weight: 600;
        margin-bottom: 8px;
        font-size: 14px;
        line-height: 1.2;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        min-height: 32px;
      }

      .product-text p {
        color: #e53637;
        font-size: 16px;
        font-weight: 700;
        margin-bottom: 12px;
      }

      .product-text .primary-btn {
        display: inline-block;
        background: #e53637;
        color: #fff;
        padding: 10px 16px;
        border-radius: 4px;
        font-weight: 600;
        transition: all 0.3s;
        text-decoration: none;
        text-align: center;
        margin-top: auto;
        border: none;
        cursor: pointer;
        font-size: 13px;
      }

      .product-text .primary-btn:hover {
        background: #fff;
        color: #e53637;
        text-decoration: none;
      }

      .product-text .primary-btn:disabled {
        background: #666;
        cursor: not-allowed;
      }

      .product-text .primary-btn:disabled:hover {
        background: #666;
        color: #fff;
      }

      .out-of-stock {
        position: absolute;
        top: 8px;
        right: 8px;
        background: #e53637;
        color: #fff;
        padding: 4px 8px;
        border-radius: 3px;
        font-size: 10px;
        font-weight: 600;
      }

      .page-btn:hover:not(.disabled) {
        background: #e53637 !important;
        border-color: #e53637 !important;
      }

      .page-btn.disabled {
        background: #333 !important;
        color: #666 !important;
        cursor: not-allowed !important;
      }

      @media (max-width: 576px) {
        .product-item {
          height: 280px;
        }

        .product-img {
          height: 130px;
        }

        .pagination {
          flex-direction: column;
          gap: 10px;
        }

        .page-info {
          margin: 10px 0 !important;
        }
      }
    </style>
  </head>

  <body>
    <!-- Message Modal -->
    <div
      id="messageModal"
      class="modal"
      style="
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
      "
    >
      <div
        class="modal-content"
        style="
          background: #1a1a1a;
          margin: 15% auto;
          padding: 30px;
          border-radius: 10px;
          width: 90%;
          max-width: 400px;
          border: 2px solid #e53637;
          text-align: center;
        "
      >
        <h2 id="modalTitle" style="color: #e53637; margin-bottom: 15px">
          Message
        </h2>
        <p
          id="modalMessage"
          style="color: #fff; margin-bottom: 25px; line-height: 1.5"
        >
          This is a message
        </p>
        <div class="modal-actions">
          <button
            id="modalConfirmBtn"
            class="btn-primary"
            style="
              background: #e53637;
              color: #fff;
              border: none;
              padding: 10px 20px;
              border-radius: 4px;
              cursor: pointer;
              font-size: 14px;
            "
          >
            OK
          </button>
        </div>
      </div>
    </div>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Offcanvas Menu Section Begin -->
    <div class="offcanvas-menu-overlay"></div>
    <div class="offcanvas-menu-wrapper">
      <div class="canvas-close">
        <i class="fa fa-close"></i>
      </div>
      <div class="canvas-search search-switch">
        <i class="fa fa-search"></i>
      </div>
      <!-- Mobile cart and profile -->
      <div class="canvas-cart-profile">
        <div class="cart-icon">
          <i class="fa fa-shopping-cart"></i>
          <span class="cart-count"></span>
        </div>
        <div class="profile-icon">
          <i class="fa fa-user"></i>
          <div class="profile-dropdown">
            <a href="./profile.html" class="profile-link">My Profile</a>
            <a href="./login.html" class="login-link">Login</a>
            <a href="./registration.html" class="register-link">Register</a>
            <a href="#" class="logout-link" style="display: none">Logout</a>
          </div>
        </div>
      </div>
      <nav class="canvas-menu mobile-menu">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="class-details.html">Classes</a></li>
          <li><a href="services.html">Services</a></li>
          <li class="active"><a href="shop.html">Shop</a></li>
          <li><a href="team.html">Our Team</a></li>
          <!-- <li>
            <a href="#">Pages</a>
            <ul class="dropdown">
              <li><a href="about-us.html">About us</a></li>
              <li><a href="class-timetable.html">Classes timetable</a></li>
              <li><a href="bmi-calculator.html">Bmi calculate</a></li>
              <li><a href="team.html">Our team</a></li>
              <li><a href="gallery.html">Gallery</a></li>
              <li><a href="blog.html">Our blog</a></li>
              <li><a href="404.html">404</a></li>
            </ul>
          </li> -->
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
      <div id="mobile-menu-wrap"></div>
      <div class="canvas-social">
        <a href="#"><i class="fa fa-facebook"></i></a>
        <a href="#"><i class="fa fa-twitter"></i></a>
        <a href="#"><i class="fa fa-youtube-play"></i></a>
        <a href="#"><i class="fa fa-instagram"></i></a>
      </div>
    </div>
    <!-- Offcanvas Menu Section End -->

    <!-- Header Section Begin -->
    <header class="header-section">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-3">
            <div class="logo">
              <a href="index.html">
                <img src="img/logo.png" alt="" />
              </a>
            </div>
          </div>
          <div class="col-lg-6">
            <nav class="nav-menu">
              <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="class-details.html">Classes</a></li>
                <li><a href="services.html">Services</a></li>
                <li class="active"><a href="shop.html">Shop</a></li>
                <li><a href="team.html">Our Team</a></li>
                <!-- <li>
                  <a href="#">Pages</a>
                  <ul class="dropdown">
                    <li><a href="about-us.html">About us</a></li>
                    <li>
                      <a href="class-timetable.html">Classes timetable</a>
                    </li>
                    <li><a href="bmi-calculator.html">Bmi calculate</a></li>
                    <li><a href="team.html">Our team</a></li>
                    <li><a href="gallery.html">Gallery</a></li>
                    <li><a href="blog.html">Our blog</a></li>
                    <li><a href="404.html">404</a></li>
                  </ul>
                </li> -->
                <li><a href="contact.html">Contact</a></li>
              </ul>
            </nav>
          </div>
          <div class="col-lg-3">
            <div class="top-option">
              <div class="to-search search-switch">
                <i class="fa fa-search"></i>
              </div>
              <!-- Cart Icon -->
              <div class="cart-icon">
                <i class="fa fa-shopping-cart"></i>
                <span class="cart-count"></span>
                <div class="cart-dropdown">
                  <div class="cart-items">
                    <div class="empty-cart">Your cart is empty</div>
                    <!-- Cart items will be added here dynamically -->
                  </div>
                  <div class="cart-total">
                    <span>Total:</span>
                    <span>N0</span>
                  </div>
                  <div class="cart-actions">
                    <a href="#" class="view-cart">View Cart</a>
                    <a href="#" class="checkout">Checkout</a>
                  </div>
                </div>
              </div>
              <!-- Profile Icon -->
              <div class="profile-icon">
                <i class="fa fa-user"></i>
                <div class="profile-dropdown">
                  <a href="./profile.html" class="profile-link">My Profile</a>
                  <a href="./login.html" class="login-link">Login</a>
                  <a href="./registration.html" class="register-link"
                    >Register</a
                  >
                  <a href="#" class="logout-link" style="display: none"
                    >Logout</a
                  >
                </div>
              </div>
              <div class="to-social">
                <a href="#"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
                <a href="#"><i class="fa fa-youtube-play"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
              </div>
            </div>
          </div>
        </div>
        <div class="canvas-open">
          <i class="fa fa-bars"></i>
        </div>
      </div>
    </header>
    <!-- Header End -->

    <!-- Breadcrumb Section Begin -->
    <section
      class="breadcrumb-section set-bg"
      data-setbg="img/breadcrumb-bg.jpg"
    >
      <div class="container">
        <div class="row">
          <div class="col-lg-12 text-center">
            <div class="breadcrumb-text">
              <h2>Ape-X Shop</h2>
              <div class="bt-option">
                <a href="index.html">Home</a>
                <span>Our Shop</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Shop Section Begin -->
    <section class="shop-section spad">
      <div class="container">
        <div class="row">
          <div class="col-lg-3 col-md-4">
            <div class="shop-sidebar">
              <h4>Categories</h4>
              <ul>
                <li><a href="#" data-category="all">All Products</a></li>
                <li><a href="#" data-category="supplements">Supplements</a></li>
                <li><a href="#" data-category="equipment">Equipment</a></li>
                <li><a href="#" data-category="apparel">Apparel</a></li>
                <li><a href="#" data-category="accessories">Accessories</a></li>
              </ul>
            </div>

            <div class="shop-sidebar">
              <h4>Filter By Price</h4>
              <div class="price-filter">
                <input type="number" id="minPrice" placeholder="Min Price" />
                <input type="number" id="maxPrice" placeholder="Max Price" />
                <button id="filterPrice">FILTER</button>
                <button
                  id="clearFilter"
                  style="margin-top: 10px; background: #333"
                >
                  CLEAR
                </button>
              </div>
            </div>
          </div>

          <div class="col-lg-9 col-md-8">
            <div class="sorting-options">
              <div class="sort-by">
                <span>Sort by:</span>
                <select id="sortSelect">
                  <option value="name_asc">Name A-Z</option>
                  <option value="name_desc">Name Z-A</option>
                  <option value="price_asc">Price: Low to High</option>
                  <option value="price_desc">Price: High to Low</option>
                  <option value="newest">Newest First</option>
                </select>
              </div>
              <div class="view-options">
                <span>Showing <span id="productCount">0</span> products</span>
              </div>
            </div>

            <!-- Updated Products Section -->
            <div class="shop-products-grid" id="productsGrid">
              <!-- Products will be loaded dynamically from Supabase -->
            </div>

            <!-- Loading State -->
            <div
              id="loadingState"
              class="text-center"
              style="color: #b7b7b7; padding: 40px"
            >
              <i
                class="fa fa-spinner fa-spin"
                style="font-size: 48px; margin-bottom: 20px"
              ></i>
              <p>Loading products...</p>
            </div>

            <!-- Empty State -->
            <div
              id="emptyState"
              class="text-center"
              style="display: none; color: #b7b7b7; padding: 40px"
            >
              <i
                class="fa fa-shopping-bag"
                style="font-size: 48px; margin-bottom: 20px"
              ></i>
              <h3>No Products Available</h3>
              <p>Check back later for new products!</p>
            </div>

            <!-- Pagination -->
            <div
              class="pagination"
              id="pagination"
              style="
                display: none;
                justify-content: center;
                margin: 30px 0;
                gap: 10px;
              "
            >
              <button
                class="page-btn"
                id="prevPage"
                onclick="changePage(currentPage - 1)"
                style="
                  background: #1a1a1a;
                  color: #fff;
                  border: 1px solid #333;
                  padding: 8px 15px;
                  border-radius: 4px;
                  cursor: pointer;
                  transition: all 0.3s;
                "
              >
                Previous
              </button>
              <span
                class="page-info"
                id="pageInfo"
                style="
                  color: #b7b7b7;
                  margin: 0 15px;
                  font-size: 14px;
                  display: flex;
                  align-items: center;
                "
                >Page 1 of 1</span
              >
              <button
                class="page-btn"
                id="nextPage"
                onclick="changePage(currentPage + 1)"
                style="
                  background: #1a1a1a;
                  color: #fff;
                  border: 1px solid #333;
                  padding: 8px 15px;
                  border-radius: 4px;
                  cursor: pointer;
                  transition: all 0.3s;
                "
              >
                Next
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Shop Section End -->

    <!-- Get In Touch Section Begin -->
    <div class="gettouch-section">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <div class="gt-text">
              <i class="fa fa-map-marker"></i>
              <p>
                333 Middle Winchendon Rd, Rindge,<br />
                NH 03461
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="gt-text">
              <i class="fa fa-mobile"></i>
              <ul>
                <li>125-711-811</li>
                <li>125-668-886</li>
              </ul>
            </div>
          </div>
          <div class="col-md-4">
            <div class="gt-text email">
              <i class="fa fa-envelope"></i>
              <p>Support.gymcenter@gmail.com</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Get In Touch Section End -->

    <!-- Footer Section Begin -->
    <section class="footer-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-4">
            <div class="fs-about">
              <div class="fa-logo">
                <a href="#"><img src="img/logo.png" alt="" /></a>
              </div>
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                eiusmod tempor incididunt ut labore dolore magna aliqua endisse
                ultrices gravida lorem.
              </p>
              <div class="fa-social">
                <a href="#"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
                <a href="#"><i class="fa fa-youtube-play"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-envelope-o"></i></a>
              </div>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-6">
            <div class="fs-widget">
              <h4>Useful links</h4>
              <ul>
                <li><a href="#">About</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Classes</a></li>
                <li><a href="#">Contact</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-6">
            <div class="fs-widget">
              <h4>Support</h4>
              <ul>
                <li><a href="#">Login</a></li>
                <li><a href="#">My account</a></li>
                <li><a href="#">Subscribe</a></li>
                <li><a href="#">Contact</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <div class="fs-widget">
              <h4>Tips & Guides</h4>
              <div class="fw-recent">
                <h6>
                  <a href="#"
                    >Physical fitness may help prevent depression, anxiety</a
                  >
                </h6>
                <ul>
                  <li>3 min read</li>
                  <li>20 Comment</li>
                </ul>
              </div>
              <div class="fw-recent">
                <h6>
                  <a href="#"
                    >Fitness: The best exercise to lose belly fat and tone
                    up...</a
                  >
                </h6>
                <ul>
                  <li>3 min read</li>
                  <li>20 Comment</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <div class="copyright-text">
              <p>
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                Copyright &copy;
                <script>
                  document.write(new Date().getFullYear());
                </script>
                All rights reserved | This template is made with
                <i class="fa fa-heart" aria-hidden="true"></i> by
                <a href="https://colorlib.com/" target="_blank">Colorlib</a>
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Footer Section End -->

    <!-- Search model Begin -->
    <div class="search-model">
      <div class="h-100 d-flex align-items-center justify-content-center">
        <div class="search-close-switch">+</div>
        <form class="search-model-form">
          <input type="text" id="search-input" placeholder="Search here....." />
        </form>
      </div>
    </div>
    <!-- Search model end -->

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script src="js/jquery.barfiller.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>

    <script>
      // Cart and pagination functionality
      document.addEventListener("DOMContentLoaded", function () {
        const cartCount = document.querySelector(".cart-count");
        const cartItems = document.querySelector(".cart-items");
        const cartTotal = document.querySelector(".cart-total span:last-child");
        const emptyCart = document.querySelector(".empty-cart");
        const loadingState = document.getElementById("loadingState");
        const emptyState = document.getElementById("emptyState");
        const productsGrid = document.getElementById("productsGrid");
        const pagination = document.getElementById("pagination");

        // Modal elements
        const messageModal = document.getElementById("messageModal");
        const modalTitle = document.getElementById("modalTitle");
        const modalMessage = document.getElementById("modalMessage");
        const modalConfirmBtn = document.getElementById("modalConfirmBtn");

        // Filter elements
        const categoryLinks = document.querySelectorAll("[data-category]");
        const minPriceInput = document.getElementById("minPrice");
        const maxPriceInput = document.getElementById("maxPrice");
        const filterPriceBtn = document.getElementById("filterPrice");
        const clearFilterBtn = document.getElementById("clearFilter");
        const sortSelect = document.getElementById("sortSelect");
        const searchInput = document.getElementById("searchInput");

        let cart = [];
        let products = [];
        let currentPage = 1;
        const itemsPerPage = 20;
        let totalPages = 1;
        let totalItems = 0;

        // Current filter state
        let currentFilters = {
          category: "all",
          minPrice: "",
          maxPrice: "",
          sortBy: "newest",
          search: "",
        };

        // Modal functionality
        modalConfirmBtn.addEventListener("click", function () {
          messageModal.style.display = "none";
        });

        // Function to show modal messages
        function showModal(title, message) {
          modalTitle.textContent = title;
          modalMessage.textContent = message;
          messageModal.style.display = "block";
        }

        // Initialize cart
        initializeCart();

        // Load products from Supabase with current filters
        loadProducts(currentPage);

        // Setup filter event listeners
        setupFilters();

        async function initializeCart() {
          try {
            const token = localStorage.getItem("supabase_token");
            if (!token) {
              // User not logged in, show empty cart
              updateCartDisplay();
              return;
            }

            // Load user's cart from backend
            await loadUserCart();
          } catch (error) {
            console.error("Cart initialization error:", error);
            updateCartDisplay();
          }
        }

        function setupFilters() {
          // Category filter
          categoryLinks.forEach((link) => {
            link.addEventListener("click", function (e) {
              e.preventDefault();
              const category = this.getAttribute("data-category");
              currentFilters.category = category;

              // Update active state
              categoryLinks.forEach((l) => l.classList.remove("active"));
              this.classList.add("active");

              loadProducts(1); // Reset to page 1 when filter changes
            });
          });

          // Price filter
          filterPriceBtn.addEventListener("click", function () {
            currentFilters.minPrice = minPriceInput.value;
            currentFilters.maxPrice = maxPriceInput.value;
            loadProducts(1);
          });

          // Clear filter
          clearFilterBtn.addEventListener("click", function () {
            minPriceInput.value = "";
            maxPriceInput.value = "";
            currentFilters.minPrice = "";
            currentFilters.maxPrice = "";
            loadProducts(1);
          });

          // Sort filter
          sortSelect.addEventListener("change", function () {
            currentFilters.sortBy = this.value;
            loadProducts(1);
          });

          // Search filter with debounce
          let searchTimeout;
          searchInput.addEventListener("input", function () {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
              currentFilters.search = this.value;
              loadProducts(1);
            }, 500);
          });
        }

        async function loadUserCart() {
          try {
            const token = localStorage.getItem("supabase_token");
            if (!token) {
              cart = [];
              updateCartDisplay();
              updateProfileDropdown();
              return;
            }

            const response = await fetch("/cart", {
              method: "GET",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
            });

            if (!response.ok) {
              if (response.status === 401) {
                // Not authenticated, clear cart
                cart = [];
                updateCartDisplay();
                updateProfileDropdown();
                return;
              }
              throw new Error("Failed to fetch cart");
            }

            const cartData = await response.json();
            cart = cartData.items || [];
            updateCartDisplay();
            updateProfileDropdown();
          } catch (error) {
            console.error("Load cart error:", error);
            cart = [];
            updateCartDisplay();
            updateProfileDropdown();
          }
        }

        async function loadProducts(page = 1) {
          try {
            showLoadingState();

            // Build query string from current filters
            const queryParams = new URLSearchParams({
              page: page,
              limit: itemsPerPage,
            });

            // Add filters to query params
            if (currentFilters.category && currentFilters.category !== "all") {
              queryParams.append("category", currentFilters.category);
            }
            if (currentFilters.minPrice) {
              queryParams.append("minPrice", currentFilters.minPrice);
            }
            if (currentFilters.maxPrice) {
              queryParams.append("maxPrice", currentFilters.maxPrice);
            }
            if (currentFilters.sortBy) {
              queryParams.append("sortBy", currentFilters.sortBy);
            }
            if (currentFilters.search) {
              queryParams.append("search", currentFilters.search);
            }

            const response = await fetch(`/admin/shop-items?${queryParams}`);

            if (!response.ok) {
              throw new Error("Failed to fetch products");
            }

            const data = await response.json();
            products = data.data;
            currentPage = data.pagination.currentPage;
            totalPages = data.pagination.totalPages;
            totalItems = data.pagination.totalItems;

            renderProducts(products);
            updatePagination();
          } catch (error) {
            console.error("Error loading products:", error);
            showErrorState(
              "Unable to load products at this time. Please try again later."
            );
          }
        }

        function changePage(page) {
          if (page < 1 || page > totalPages) return;
          loadProducts(page);
          // Scroll to top of products
          productsGrid.scrollIntoView({ behavior: "smooth" });
        }

        function updatePagination() {
          const prevBtn = document.getElementById("prevPage");
          const nextBtn = document.getElementById("nextPage");
          const pageInfo = document.getElementById("pageInfo");

          if (totalPages <= 1) {
            pagination.style.display = "none";
            return;
          }

          pagination.style.display = "flex";
          pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;

          prevBtn.disabled = currentPage === 1;
          prevBtn.className =
            currentPage === 1 ? "page-btn disabled" : "page-btn";

          nextBtn.disabled = currentPage === totalPages;
          nextBtn.className =
            currentPage === totalPages ? "page-btn disabled" : "page-btn";
        }

        function showLoadingState() {
          loadingState.style.display = "block";
          productsGrid.style.display = "none";
          emptyState.style.display = "none";
          pagination.style.display = "none";
        }

        function showErrorState(message) {
          loadingState.style.display = "none";
          productsGrid.style.display = "none";
          emptyState.style.display = "block";
          pagination.style.display = "none";
          emptyState.innerHTML = `
            <i class="fa fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 20px;"></i>
            <h3>Error Loading Products</h3>
            <p>${message}</p>
            <button class="primary-btn" onclick="loadProducts(currentPage)" style="margin-top: 15px; background: #e53637; color: #fff; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
              <i class="fa fa-refresh"></i> Try Again
            </button>
          `;
        }

        function renderProducts(products) {
          loadingState.style.display = "none";

          if (!products || products.length === 0) {
            productsGrid.style.display = "none";
            emptyState.style.display = "block";
            pagination.style.display = "none";
            return;
          }

          productsGrid.style.display = "grid";
          emptyState.style.display = "none";

          // Update product count
          document.getElementById("productCount").textContent = totalItems;

          productsGrid.innerHTML = products
            .map((product) => {
              const isAvailable =
                product.stock > 0 && product.status === "active";
              const buttonText = !isAvailable ? "Out of Stock" : "Add to cart";
              const buttonClass = !isAvailable
                ? "primary-btn disabled"
                : "primary-btn add-to-cart-btn";

              return `
              <div class="product-item">
                <div class="product-img">
                  <img src="${
                    product.image_url ||
                    "https://via.placeholder.com/500x300/222/666?text=No+Image"
                  }" 
                       alt="${product.name}" 
                       onerror="this.src='https://via.placeholder.com/500x300/222/666?text=No+Image'" />
                  ${
                    !isAvailable
                      ? '<div class="out-of-stock">Out of Stock</div>'
                      : ""
                  }
                </div>
                <div class="product-text">
                  <h5>${product.name}</h5>
                  <p>₦${
                    typeof product.price === "number"
                      ? product.price.toLocaleString()
                      : "0"
                  }</p>
                  <button class="${buttonClass}" 
                         data-id="${product.id}"
                         data-name="${product.name}"
                         data-price="${product.price}"
                         data-image="${product.image_url}"
                         ${!isAvailable ? "disabled" : ""}>
                    ${buttonText}
                  </button>
                </div>
              </div>
            `;
            })
            .join("");

          // Re-attach event listeners to new buttons
          document.querySelectorAll(".add-to-cart-btn").forEach((button) => {
            button.addEventListener("click", function (e) {
              e.preventDefault();
              addToCart(this);
            });
          });
        }

        async function addToCart(button) {
          const productId = button.getAttribute("data-id");
          const productName = button.getAttribute("data-name");
          const productPrice = parseFloat(button.getAttribute("data-price"));
          const productImage = button.getAttribute("data-image");

          // Check if user is logged in
          const token = localStorage.getItem("supabase_token");
          if (!token) {
            showModal("Login Required", "Please login to add items to cart");
            setTimeout(() => {
              window.location.href = "login.html";
            }, 2000);
            return;
          }

          try {
            const response = await fetch("/cart/add", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
              body: JSON.stringify({
                productId: parseInt(productId),
                quantity: 1,
              }),
            });

            if (!response.ok) {
              const errorData = await response.json();
              throw new Error(errorData.error || "Failed to add to cart");
            }

            const result = await response.json();

            // Reload cart to get updated data
            await loadUserCart();

            // Show feedback
            const originalText = button.textContent;
            button.textContent = "Added!";
            button.style.background = "#28a745";
            setTimeout(() => {
              button.textContent = originalText;
              button.style.background = "#e53637";
            }, 1000);
          } catch (error) {
            console.error("Add to cart error:", error);
            showModal("Error", "Error adding to cart: " + error.message);
          }
        }

        function updateCartDisplay() {
          // Get ALL cart count elements (desktop and mobile)
          const cartCountElements = document.querySelectorAll(".cart-count");

          // Update all cart count elements
          cartCountElements.forEach((element) => {
            element.textContent = cart.length;
          });

          // Show/hide empty cart message
          if (cart.length === 0) {
            emptyCart.style.display = "block";
            document.querySelector(".cart-total").style.display = "none";
            document.querySelector(".cart-actions").style.display = "none";
          } else {
            emptyCart.style.display = "none";
            document.querySelector(".cart-total").style.display = "flex";
            document.querySelector(".cart-actions").style.display = "flex";
          }

          // Update cart items
          cartItems.innerHTML = "";
          let total = 0;

          cart.forEach((item) => {
            const itemTotal = item.quantity * item.shop_items.price;
            total += itemTotal;

            const cartItem = document.createElement("div");
            cartItem.className = "cart-item";
            cartItem.innerHTML = `
              <img src="${
                item.shop_items.image_url ||
                "https://via.placeholder.com/50x50/222/666?text=No+Img"
              }" alt="${item.shop_items.name}">
              <div class="cart-item-details">
                <div class="cart-item-name">${item.shop_items.name}</div>
                <div class="cart-item-price">
                  ₦${item.shop_items.price.toLocaleString()} x ${item.quantity}
                </div>
                <div class="cart-item-total" style="color: #e53637; font-weight: bold;">
                  ₦${itemTotal.toLocaleString()}
                </div>
              </div>
              <button class="remove-cart-item" data-product-id="${
                item.product_id
              }" 
                      style="background: none; border: none; color: #e53637; cursor: pointer; margin-left: 10px;">
                <i class="fa fa-times"></i>
              </button>
            `;
            cartItems.appendChild(cartItem);
          });

          // Add event listeners to remove buttons
          document.querySelectorAll(".remove-cart-item").forEach((button) => {
            button.addEventListener("click", function () {
              const productId = this.getAttribute("data-product-id");
              removeFromCart(productId);
            });
          });

          // Update total
          cartTotal.textContent = `₦${total.toLocaleString()}`;
        }

        async function removeFromCart(productId) {
          const token = localStorage.getItem("supabase_token");
          if (!token) {
            showModal("Login Required", "Please login to modify cart");
            return;
          }

          try {
            const response = await fetch(`/cart/remove/${productId}`, {
              method: "DELETE",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
            });

            if (!response.ok) {
              throw new Error("Failed to remove item from cart");
            }

            // Reload cart
            await loadUserCart();
            // No modal for removal - it happens silently as requested
          } catch (error) {
            console.error("Remove from cart error:", error);
            showModal("Error", "Error removing item from cart");
          }
        }

        function updateProfileDropdown() {
          const token = localStorage.getItem("supabase_token");
          const loginLinks = document.querySelectorAll(".login-link");
          const registerLinks = document.querySelectorAll(".register-link");
          const logoutLinks = document.querySelectorAll(".logout-link");
          const profileLinks = document.querySelectorAll(".profile-link");

          if (token) {
            // User is logged in
            loginLinks.forEach((link) => (link.style.display = "none"));
            registerLinks.forEach((link) => (link.style.display = "none"));
            logoutLinks.forEach((link) => (link.style.display = "block"));
            profileLinks.forEach((link) => (link.style.display = "block"));
          } else {
            // User is not logged in
            loginLinks.forEach((link) => (link.style.display = "block"));
            registerLinks.forEach((link) => (link.style.display = "block"));
            logoutLinks.forEach((link) => (link.style.display = "none"));
            profileLinks.forEach((link) => (link.style.display = "none"));
          }
        }

        // Update cart actions to work with authenticated user
        document
          .querySelector(".view-cart")
          .addEventListener("click", function (e) {
            e.preventDefault();
            showModal("Coming Soon", "View cart page is coming soon!");
          });

        document
          .querySelector(".checkout")
          .addEventListener("click", function (e) {
            e.preventDefault();
            const token = localStorage.getItem("supabase_token");
            if (!token) {
              showModal("Login Required", "Please login to checkout");
              setTimeout(() => {
                window.location.href = "login.html";
              }, 2000);
              return;
            }
            showModal("Coming Soon", "Checkout page is coming soon!");
          });

        // Profile dropdown functionality for mobile
        const mobileProfileIcon = document.querySelector(
          ".canvas-cart-profile .profile-icon"
        );
        if (mobileProfileIcon) {
          mobileProfileIcon.addEventListener("click", function () {
            const dropdown = this.querySelector(".profile-dropdown");
            dropdown.style.display =
              dropdown.style.display === "block" ? "none" : "block";
          });
        }

        // Logout functionality
        document.querySelectorAll(".logout-link").forEach((link) => {
          link.addEventListener("click", async function (e) {
            e.preventDefault();

            try {
              const response = await fetch("/auth/logout", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
              });

              localStorage.removeItem("supabase_token");
              cart = [];
              updateCartDisplay();
              updateProfileDropdown();

              showModal("Success", "Logout successful!");
              // Refresh the page to update UI
              setTimeout(() => {
                window.location.reload();
              }, 2000);
            } catch (error) {
              console.error("Logout error:", error);
              localStorage.removeItem("supabase_token");
              window.location.reload();
            }
          });
        });

        // Make functions global for pagination
        window.changePage = changePage;
        window.loadProducts = loadProducts;
        window.currentPage = currentPage;
        window.showModal = showModal;
      });
    </script>
  </body>
</html>
